function returnRezulText(){if(""==document.getElementById(rteFormName).style.display)var e=getXHTML(trim(document.getElementById(rteFormName).value));else var e=getXHTML(trim(document.getElementById(rteName).contentWindow.document.body.innerHTML));if(pattern=/<div[^>]*border: 1px dotted red[^>]*>.*<\/form><\/div>/gi,matchesArray=e.match(pattern),null!=matchesArray)for(i=0;i<matchesArray.length;i++)pattern2=/<div[^>]*border: 1px dotted red[^>]*>/gi,pattern3=/<\/div>/gi,replacement=matchesArray[i],replacement=replacement.replace(pattern2,""),replacement=replacement.replace(pattern3,""),e=""==document.getElementById(rteFormName).style.display?document.getElementById(rteFormName).value.replace(matchesArray[i],replacement):document.getElementById(rteName).contentWindow.document.body.innerHTML.replace(matchesArray[i],replacement);if(pattern=/<table[^>]*class=\"rte_tbl\"[^>]*>/gi,matchesArray=e.match(pattern),null!=matchesArray)for(i=0;i<matchesArray.length;i++)pattern2=/class=\"rte_tbl\"/gi,replacement=matchesArray[i],replacement=replacement.replace(pattern2,""),e=e.replace(matchesArray[i],replacement);document.getElementById("postcardText").innerHTML=e,$("#mbox-overlay").hide(),$("#mbox-overlay").remove(),$("#text-editor").css({display:"none"})}function closeWithOutRezulText(){$("#mbox-overlay").hide(),$("#mbox-overlay").remove(),$("#text-editor").css({display:"none"})}function getXHTML(e){return new Html2Xhtml(e).parse()}function Html2Xhtml(e){this.data=e||""}function trim(e){return"string"!=typeof e?e:e=e.replace(/^\s+|\s+$/g,"")}function rteGetOffsetTop(e){for(var t=e.offsetTop,o=e.offsetParent;o;)t+=o.offsetTop,o=o.offsetParent;return t}function rteGetOffsetLeft(e){for(var t=e.offsetLeft,o=e.offsetParent;o;)t+=o.offsetLeft,o=o.offsetParent;return t}function rteHideMenus(){rteMouseOutFontFaceMenu(),document.getElementById("fontface3").style.display="none",rteMouseOutFontSizeMenu(),document.getElementById("fontsize3").style.display="none",rteMouseOutFontColorMenu(),document.getElementById("fontcolor3").style.display="none",checkInputTextSize()}function rteColorClick(e){rteHideMenus(),document.getElementById(rteName).contentWindow.document.execCommand("forecolor",!1,e),document.getElementById("fontcolor4").style.backgroundColor=e}function rteMouseOverMenuFontColorContents(){this.className="rtedropdown14"}function rteMouseOutMenuFontColorContents(){this.className="rtedropdown13"}function rteMouseOverMenuContents(){this.style.color="#FFFFFF",this.style.backgroundColor="#316AC5",document.getElementById(rteName).contentWindow.focus()}function rteMouseOutMenuContents(){this.style.color="#000000",this.style.backgroundColor="#FFFFFF"}function rteMouseDownMenuContents(){"Header 1"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<h1>"),document.getElementById("format1").innerHTML="Header 1"):"Header 2"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<h2>"),document.getElementById("format1").innerHTML="Header 2"):"Header 3"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<h3>"),document.getElementById("format1").innerHTML="Header 3"):"Header 4"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<h4>"),document.getElementById("format1").innerHTML="Header 4"):"Header 5"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<h5>"),document.getElementById("format1").innerHTML="Header 5"):"Header 6"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<h6>"),document.getElementById("format1").innerHTML="Header 6"):"Paragraph"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("formatblock",!1,"<p>"),document.getElementById("format1").innerHTML="Paragraph"):"Arial"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"arial"),document.getElementById("fontface1").innerHTML="Arial"):"Arial Black"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"arial black"),document.getElementById("fontface1").innerHTML="Arial Black"):"Arial Narrow"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"arial narrow"),document.getElementById("fontface1").innerHTML="Arial Narrow"):"Courier New"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"courier new"),document.getElementById("fontface1").innerHTML="Courier New"):"Century Gothic"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"century gothic"),document.getElementById("fontface1").innerHTML="Century Gothic"):"Comic Sans MS"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"comic sans ms"),document.getElementById("fontface1").innerHTML="Comic Sans MS"):"Impact"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"impact"),document.getElementById("fontface1").innerHTML="Impact"):"Tahoma"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"tahoma"),document.getElementById("fontface1").innerHTML="Tahoma"):"Times New Roman"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"times new roman"),document.getElementById("fontface1").innerHTML="Times New Roman"):"Trebuchet MS"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"trebuchet ms"),document.getElementById("fontface1").innerHTML="Trebuchet MS"):"Verdana"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontname",!1,"verdana"),document.getElementById("fontface1").innerHTML="Verdana"):"1"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"1"),document.getElementById("fontsize1").innerHTML="1"):"2"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"2"),document.getElementById("fontsize1").innerHTML="2"):"3"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"3"),document.getElementById("fontsize1").innerHTML="3"):"4"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"4"),document.getElementById("fontsize1").innerHTML="4"):"5"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"5"),document.getElementById("fontsize1").innerHTML="5"):"6"==this.innerHTML?(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"6"),document.getElementById("fontsize1").innerHTML="6"):"7"==this.innerHTML&&(document.getElementById(rteName).contentWindow.document.execCommand("fontsize",!1,"7"),document.getElementById("fontsize1").innerHTML="7"),this.style.color="#000000",this.style.backgroundColor="#FFFFFF",rteHideMenus()}function rteMouseOverFormatMenu(){document.getElementById("format1").className="rtedropdown4",document.getElementById("format2").className="rtedropdown5"}function rteMouseDownFormatMenu(){rteHideMenus(),document.getElementById("format1").className="rtedropdown4",document.getElementById("format2").className="rtedropdown6",document.getElementById("format1").style.left=rteGetOffsetLeft(document.getElementById("format1")),document.getElementById("format1").style.top=rteGetOffsetTop(document.getElementById("format1"))+document.getElementById("format1").offsetHeight,document.getElementById("format3").style.display="none"==document.getElementById("format3").style.display?"":"none";for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++)"format1"==e[t].id||"format2"==e[t].id?e[t].onmouseout=rteMouseDownFormatMenu:"fontface1"==e[t].id||"fontface2"==e[t].id?e[t].onmouseout=rteMouseOutFontFaceMenu:"fontsize1"==e[t].id||"fontsize2"==e[t].id?e[t].onmouseout=rteMouseOutFontSizeMenu:"fontcolor1"!=e[t].id&&"fontcolor2"!=e[t].id||(e[t].onmouseout=rteMouseOutFontColorMenu)}function rteMouseOverFontFaceMenu(){document.getElementById("fontface1").className="rtedropdown4",document.getElementById("fontface2").className="rtedropdown5"}function rteMouseDownFontFaceMenu(){rteHideMenus(),document.getElementById("fontface1").className="rtedropdown4",document.getElementById("fontface2").className="rtedropdown6",document.getElementById("fontface1").style.left=rteGetOffsetLeft(document.getElementById("fontface1")),document.getElementById("fontface1").style.top=rteGetOffsetTop(document.getElementById("fontface1"))+document.getElementById("fontface1").offsetHeight,document.getElementById("fontface3").style.display="none"==document.getElementById("fontface3").style.display?"":"none";for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++)"fontface1"==e[t].id||"fontface2"==e[t].id?e[t].onmouseout=rteMouseDownFontFaceMenu:"fontsize1"==e[t].id||"fontsize2"==e[t].id?e[t].onmouseout=rteMouseOutFontSizeMenu:"fontcolor1"!=e[t].id&&"fontcolor2"!=e[t].id||(e[t].onmouseout=rteMouseOutFontColorMenu)}function rteMouseOutFontFaceMenu(){document.getElementById("fontface1").className="rtedropdown1",document.getElementById("fontface2").className="rtedropdown2"}function rteMouseOverFontSizeMenu(){document.getElementById("fontsize1").className="rtedropdown4",document.getElementById("fontsize2").className="rtedropdown5"}function rteMouseDownFontSizeMenu(){rteHideMenus(),document.getElementById("fontsize1").className="rtedropdown4",document.getElementById("fontsize2").className="rtedropdown6",document.getElementById("fontsize1").style.left=rteGetOffsetLeft(document.getElementById("fontsize1")),document.getElementById("fontsize1").style.top=rteGetOffsetTop(document.getElementById("fontsize1"))+document.getElementById("fontsize1").offsetHeight,document.getElementById("fontsize3").style.display="none"==document.getElementById("fontsize3").style.display?"":"none";for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++)"fontface1"==e[t].id||"fontface2"==e[t].id?e[t].onmouseout=rteMouseOutFontFaceMenu:"fontsize1"==e[t].id||"fontsize2"==e[t].id?e[t].onmouseout=rteMouseDownFontSizeMenu:"fontcolor1"!=e[t].id&&"fontcolor2"!=e[t].id||(e[t].onmouseout=rteMouseOutFontColorMenu)}function rteMouseOutFontSizeMenu(){document.getElementById("fontsize1").className="rtedropdown1",document.getElementById("fontsize2").className="rtedropdown2"}function rteMouseOverFontColorMenu(){document.getElementById("fontcolor1").className="rtedropdown8",document.getElementById("fontcolor2").className="rtedropdown5b"}function rteMouseDownFontColorMenu(){rteHideMenus(),document.getElementById("fontcolor1").className="rtedropdown12",document.getElementById("fontcolor2").className="rtedropdown9b",document.getElementById("fontcolor1").style.left=rteGetOffsetLeft(document.getElementById("fontcolor1")),document.getElementById("fontcolor1").style.top=rteGetOffsetTop(document.getElementById("fontcolor1"))+document.getElementById("fontcolor1").offsetHeight,document.getElementById("fontcolor3").style.display="none"==document.getElementById("fontcolor3").style.display?"":"none";for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++)"fontface1"==e[t].id||"fontface2"==e[t].id?e[t].onmouseout=rteMouseOutFontFaceMenu:"fontsize1"==e[t].id||"fontsize2"==e[t].id?e[t].onmouseout=rteMouseOutFontSizeMenu:"fontcolor1"!=e[t].id&&"fontcolor2"!=e[t].id||(e[t].onmouseout=rteMouseDownFontColorMenu)}function rteMouseOutFontColorMenu(){document.getElementById("fontcolor1").className="rtedropdown10",document.getElementById("fontcolor2").className="rtedropdown11b"}function rteBtnMouseUpBottom(){this.className="rtebtn9"}function rteBtnMouseOutBottom(){this.className="rtebtn6"}function rteBtnMouseOutDownBottom(){this.className="rtebtn9"}function rteBtnMouseOverBottom(){this.className="rtebtn7"}function rteBtnMouseDownBottom(){for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++)"rtebtn6"!=e[t].className&&"rtebtn7"!=e[t].className&&"rtebtn8"!=e[t].className&&"rtebtn9"!=e[t].className||(e[t].className="rtebtn6",e[t].onmouseover=rteBtnMouseOverBottom,e[t].onmouseout=rteBtnMouseOutBottom,e[t].onmousedown=rteBtnMouseDownBottom,e[t].onmouseup=rteBtnMouseUpBottom);this.className="rtebtn9",this.onmouseover=rteBtnMouseOverBottom,this.onmouseout=rteBtnMouseOutDownBottom,this.onmouseup=rteBtnMouseUpBottom}function rteBtnMouseDown(){for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++)"rtebtn2"!=e[t].className&&"rtebtn3"!=e[t].className&&"rtebtn4"!=e[t].className||(e[t].className="rtebtn1");rteSelection(),this.className="rtebtn4"}function rteBtnMouseUp(){this.className="rtebtn4"}function rteBtnMouseOut(){this.className="rtebtn1"}function rteBtnMouseOver(){this.className="rtebtn2"}function rteAction(e){rteHideMenus(),"editlink"!=this.id&&"insertflash"!=this.id&&"edittable"!=this.id&&"createlink"!=this.id&&"insertimage"!=this.id&&"inserttable"!=this.id&&"insertrowbelow"!=this.id&&"insertrowabove"!=this.id&&"insertcolumnleft"!=this.id&&"insertcolumnright"!=this.id&&"deletecolumn"!=this.id&&"deleterow"!=this.id&&"insertform"!=this.id&&"form_checkbox"!=this.id&&"form_radio"!=this.id&&"form_dropdown"!=this.id&&"form_textarea"!=this.id&&"form_submit"!=this.id&&"form_image_submit"!=this.id&&"form_reset"!=this.id&&"form_hidden"!=this.id&&"form_password"!=this.id&&"form_textfield"!=this.id&&"spellcheck"!=this.id&&"printrte"!=this.id&&"aboutrte"!=this.id&&(document.getElementById(rteName).contentWindow.document.execCommand(this.id,!1,null),document.getElementById(this.id).className="rtebtn4",document.getElementById(this.id).onmouseout=rteBtnMouseDown,document.getElementById(rteName).contentWindow.focus())}function startRTE(e){rteCSS=document.getElementById("preview_css").value,document.getElementById(rteName).contentWindow.document.designMode="on",document.getElementById(rteFormName).value=e,document.getElementById(rteName).contentWindow.document.open(),document.getElementById(rteName).contentWindow.document.write("<html>"),document.getElementById(rteName).contentWindow.document.write("  <head>"),document.getElementById(rteName).contentWindow.document.write('    <style type="text/css">@import url('+rteCSS+");</style>"),document.getElementById(rteName).contentWindow.document.write("  </head>"),document.getElementById(rteName).contentWindow.document.write('  <body id="textBody" class="textBody" style="overflow-y: scroll; height:101%">'),document.getElementById(rteName).contentWindow.document.write(e),document.getElementById(rteName).contentWindow.document.write("  </body>"),document.getElementById(rteName).contentWindow.document.write("</html>"),document.getElementById(rteName).contentWindow.document.close(),document.all&&!window.opera?(document.getElementById(rteName).contentWindow.document.attachEvent("onkeypress",rteSelection),document.getElementById(rteName).contentWindow.document.attachEvent("onclick",rteSelection),document.getElementById(rteName).contentWindow.document.attachEvent("onmouseup",rteSelection)):(document.getElementById(rteName).contentWindow.document.execCommand("useCSS",!1,null),document.getElementById(rteName).contentWindow.document.addEventListener("keypress",rteSelection,!0),document.getElementById(rteName).contentWindow.document.addEventListener("click",rteSelection,!0),document.getElementById(rteName).contentWindow.document.addEventListener("mouseup",rteSelection,!0)),rteSelection();for(var t=document.getElementsByTagName("DIV"),o=0;o<t.length;o++)"rtebtn6"==t[o].className&&(t[o].onmouseover=rteBtnMouseOverBottom,t[o].onmouseout=rteBtnMouseOutBottom,t[o].onmousedown=rteBtnMouseDownBottom,t[o].onmouseup=rteBtnMouseUpBottom)}function rteSelection(){rteHideMenus(),document.getElementById("fontface1").innerHTML="Verdana",document.getElementById("fontsize1").innerHTML="2";for(var e=document.getElementsByTagName("DIV"),t=0;t<e.length;t++){switch(e[t].className){case"rtebtn1":e[t].onmouseover!=rteBtnMouseOver&&(e[t].onmouseover=rteBtnMouseOver),e[t].onclick!=rteAction&&(e[t].onclick=rteAction),"rtebtn4"==e[t].className?e[t].onmouseout!=rteBtnMouseDown&&(e[t].onmouseout=rteBtnMouseDown):e[t].onmouseout!=rteBtnMouseOut&&(e[t].onmouseout=rteBtnMouseOut),e[t].onmousedown!=rteBtnMouseDown&&(e[t].onmousedown=rteBtnMouseDown),e[t].onmouseup!=rteBtnMouseUp&&(e[t].onmouseup=rteBtnMouseUp);break;case"rtebtn2":e[t].className="rtebtn1",e[t].onmouseover!=rteBtnMouseOver&&(e[t].onmouseover=rteBtnMouseOver),e[t].onclick!=rteAction&&(e[t].onclick=rteAction),"rtebtn4"==e[t].className?(e[t].onmouseout=rteBtnMouseDown)&&(e[t].onmouseout=rteBtnMouseDown):e[t].onmouseout!=rteBtnMouseOut&&(e[t].onmouseout=rteBtnMouseOut),e[t].onmousedown!=rteBtnMouseDown&&(e[t].onmousedown=rteBtnMouseDown),e[t].onmouseup!=rteBtnMouseUp&&(e[t].onmouseup=rteBtnMouseUp);break;case"rtebtn3":e[t].className="rtebtn1",e[t].onmouseover!=rteBtnMouseOver&&(e[t].onmouseover=rteBtnMouseOver),e[t].onclick!=rteAction&&(e[t].onclick=rteAction),"rtebtn4"==e[t].className?e[t].onmouseout!=rteBtnMouseDown&&(e[t].onmouseout=rteBtnMouseDown):e[t].onmouseout!=rteBtnMouseOut&&(e[t].onmouseout=rteBtnMouseOut),e[t].onmousedown!=rteBtnMouseDown&&(e[t].onmousedown=rteBtnMouseDown),e[t].onmouseup!=rteBtnMouseUp&&(e[t].onmouseup=rteBtnMouseUp);break;case"rtebtn4":e[t].className="rtebtn1",e[t].onmouseover!=rteBtnMouseOver&&(e[t].onmouseover=rteBtnMouseOver),e[t].onclick!=rteAction&&(e[t].onclick=rteAction),e[t].onmouseout!=rteBtnMouseOut&&(e[t].onmouseout=rteBtnMouseOut),e[t].onmousedown!=rteBtnMouseDown&&(e[t].onmousedown=rteBtnMouseDown),e[t].onmouseup!=rteBtnMouseUp&&(e[t].onmouseup=rteBtnMouseUp)}switch(e[t].id){case"fontface1":e[t].onmouseover!=rteMouseOverFontFaceMenu&&(e[t].onmouseover=rteMouseOverFontFaceMenu),e[t].onmousedown!=rteMouseDownFontFaceMenu&&(e[t].onmousedown=rteMouseDownFontFaceMenu),e[t].onmouseout!=rteMouseOutFontFaceMenu&&(e[t].onmouseout=rteMouseOutFontFaceMenu),"rtedropdown6"==e[t].className?e[t].onmouseout!=rteMouseDownFontFaceMenu&&(e[t].onmouseout=rteMouseDownFontFaceMenu):e[t].onmouseout!=rteMouseOutFontFaceMenu&&(e[t].onmouseout=rteMouseOutFontFaceMenu);break;case"fontface2":e[t].onmouseover!=rteMouseOverFontFaceMenu&&(e[t].onmouseover=rteMouseOverFontFaceMenu),e[t].onmousedown!=rteMouseDownFontFaceMenu&&(e[t].onmousedown=rteMouseDownFontFaceMenu),e[t].onmouseout!=rteMouseOutFontFaceMenu&&(e[t].onmouseout=rteMouseOutFontFaceMenu),"rtedropdown6"==e[t].className?e[t].onmouseout!=rteMouseDownFontFaceMenu&&(e[t].onmouseout=rteMouseDownFontFaceMenu):e[t].onmouseout!=rteMouseOutFontFaceMenu&&(e[t].onmouseout=rteMouseOutFontFaceMenu);break;case"fontsize1":e[t].onmouseover!=rteMouseOverFontSizeMenu&&(e[t].onmouseover=rteMouseOverFontSizeMenu),e[t].onmousedown!=rteMouseDownFontSizeMenu&&(e[t].onmousedown=rteMouseDownFontSizeMenu),e[t].onmouseout!=rteMouseOutFontSizeMenu&&(e[t].onmouseout=rteMouseOutFontSizeMenu),"rtedropdown6"==e[t].className?e[t].onmouseout!=rteMouseDownFontSizeMenu&&(e[t].onmouseout=rteMouseDownFontSizeMenu):e[t].onmouseout!=rteMouseOutFontSizeMenu&&(e[t].onmouseout=rteMouseOutFontSizeMenu);break;case"fontsize2":e[t].onmouseover!=rteMouseOverFontSizeMenu&&(e[t].onmouseover=rteMouseOverFontSizeMenu),e[t].onmousedown!=rteMouseDownFontSizeMenu&&(e[t].onmousedown=rteMouseDownFontSizeMenu),e[t].onmouseout!=rteMouseOutFontSizeMenu&&(e[t].onmouseout=rteMouseOutFontSizeMenu),"rtedropdown6"==e[t].className?e[t].onmouseout!=rteMouseDownFontSizeMenu&&(e[t].onmouseout=rteMouseDownFontSizeMenu):e[t].onmouseout!=rteMouseOutFontSizeMenu&&(e[t].onmouseout=rteMouseOutFontSizeMenu);break;case"fontcolor1":e[t].onmouseover!=rteMouseOverFontColorMenu&&(e[t].onmouseover=rteMouseOverFontColorMenu),e[t].onmousedown!=rteMouseDownFontColorMenu&&(e[t].onmousedown=rteMouseDownFontColorMenu),e[t].onmouseout!=rteMouseOutFontColorMenu&&(e[t].onmouseout=rteMouseOutFontColorMenu),"rtedropdown9"==e[t].className?e[t].onmouseout!=rteMouseDownFontColorMenu&&(e[t].onmouseout=rteMouseDownFontColorMenu):e[t].onmouseout!=rteMouseOutFontColorMenu&&(e[t].onmouseout=rteMouseOutFontColorMenu);break;case"fontcolor2":e[t].onmouseover!=rteMouseOverFontColorMenu&&(e[t].onmouseover=rteMouseOverFontColorMenu),e[t].onmousedown!=rteMouseDownFontColorMenu&&(e[t].onmousedown=rteMouseDownFontColorMenu),e[t].onmouseout!=rteMouseOutFontColorMenu&&(e[t].onmouseout=rteMouseOutFontColorMenu),"rtedropdown9"==e[t].className?e[t].onmouseout!=rteMouseDownFontColorMenu&&(e[t].onmouseout=rteMouseDownFontColorMenu):e[t].onmouseout!=rteMouseOutFontColorMenu&&(e[t].onmouseout=rteMouseOutFontColorMenu);break;case"formatblock":e[t].onmouseover!=rteMouseOverMenuContents&&(e[t].onmouseover=rteMouseOverMenuContents),e[t].onmouseout!=rteMouseOutMenuContents&&(e[t].onmouseout=rteMouseOutMenuContents),e[t].onmousedown!=rteMouseDownMenuContents&&(e[t].onmousedown=rteMouseDownMenuContents);break;case"fontface":e[t].onmouseover!=rteMouseOverMenuContents&&(e[t].onmouseover=rteMouseOverMenuContents),e[t].onmouseout!=rteMouseOutMenuContents&&(e[t].onmouseout=rteMouseOutMenuContents),e[t].onmousedown!=rteMouseDownMenuContents&&(e[t].onmousedown=rteMouseDownMenuContents);break;case"fontsize":e[t].onmouseover!=rteMouseOverMenuContents&&(e[t].onmouseover=rteMouseOverMenuContents),e[t].onmouseout!=rteMouseOutMenuContents&&(e[t].onmouseout=rteMouseOutMenuContents),e[t].onmousedown!=rteMouseDownMenuContents&&(e[t].onmousedown=rteMouseDownMenuContents);break;case"fontcolor":e[t].onmouseover!=rteMouseOverMenuFontColorContents&&(e[t].onmouseover=rteMouseOverMenuFontColorContents),e[t].onmouseout!=rteMouseOutMenuFontColorContents&&(e[t].onmouseout=rteMouseOutMenuFontColorContents)}}var o=!1;if(window.getSelection)var n=document.getElementById(rteName).contentWindow.window.getSelection().focusNode;else if(document.getSelection)var n=document.getElementById(rteName).contentWindow.document.getSelection().focusNode;else if(document.selection)var n=document.getElementById(rteName).contentWindow.document.selection.createRange().parentElement();var r=!1,d=!1,i=n,c="";if(document.getElementById("fontcolor4").style.backgroundColor="#000000",0!=$(n).length)for(var m=n.tagName;"HTML"!=m;)"B"!=m&&"STRONG"!=m||(document.getElementById("bold").className="rtebtn4",document.getElementById("bold").onmouseout=rteBtnMouseDown),"LI"==m&&(o=!0),"TD"!=m||d||(d=!0),"I"!=m&&"EM"!=m||(document.getElementById("italic").className="rtebtn4",document.getElementById("italic").onmouseout=rteBtnMouseDown),"U"==m&&(document.getElementById("underline").className="rtebtn4",document.getElementById("underline").onmouseout=rteBtnMouseDown),"A"==m&&(r=!0,document.getElementById("editlink").className="rtebtn4",document.getElementById("editlink").onmouseout=rteBtnMouseDown),"UL"==m&&(document.getElementById("insertunorderedlist").className="rtebtn4",document.getElementById("insertunorderedlist").onmouseout=rteBtnMouseDown),"OL"==m&&(document.getElementById("insertorderedlist").className="rtebtn4",document.getElementById("insertorderedlist").onmouseout=rteBtnMouseDown),"BLOCKQUOTE"==m&&(document.getElementById("indent").className="rtebtn4",document.getElementById("indent").onmouseout=rteBtnMouseDown),"left"==i.align?(document.getElementById("justifyleft").className="rtebtn4",document.getElementById("justifyleft").onmouseout=rteBtnMouseDown):"center"==i.align?(document.getElementById("justifycenter").className="rtebtn4",document.getElementById("justifycenter").onmouseout=rteBtnMouseDown):"right"==i.align?(document.getElementById("justifyright").className="rtebtn4",document.getElementById("justifyright").onmouseout=rteBtnMouseDown):"justify"==i.align?(document.getElementById("justifyfull").className="rtebtn4",document.getElementById("justifyfull").onmouseout=rteBtnMouseDown):""==i.align&&(document.getElementById("justifyleft").className="rtebtn1"),"arial"==i.face?document.getElementById("fontface1").innerHTML="Arial":"arial black"==i.face?document.getElementById("fontface1").innerHTML="Arial Black":"arial narrow"==i.face?document.getElementById("fontface1").innerHTML="Arial Narrow":"courier new"==i.face?document.getElementById("fontface1").innerHTML="Courier New":"century gothic"==i.face?document.getElementById("fontface1").innerHTML="Century Gothic":"comic sans ms"==i.face?document.getElementById("fontface1").innerHTML="Comic Sans MS":"impact"==i.face?document.getElementById("fontface1").innerHTML="Impact":"tahoma"==i.face?document.getElementById("fontface1").innerHTML="Tahoma":"times new roman"==i.face?document.getElementById("fontface1").innerHTML="Times New Roman":"trebuchet ms"==i.face?document.getElementById("fontface1").innerHTML="Trebuchet MS":"verdana"==i.face&&(document.getElementById("fontface1").innerHTML="Verdana"),"1"==i.size?document.getElementById("fontsize1").innerHTML="1":"2"==i.size?document.getElementById("fontsize1").innerHTML="2":"3"==i.size?document.getElementById("fontsize1").innerHTML="3":"4"==i.size?document.getElementById("fontsize1").innerHTML="4":"5"==i.size?document.getElementById("fontsize1").innerHTML="5":"6"==i.size?document.getElementById("fontsize1").innerHTML="6":"7"==i.size&&(document.getElementById("fontsize1").innerHTML="7"),null!=i.color&&(c=i.color),i=i.parentNode,m=i.tagName;""==c&&(c="#000000"),document.getElementById("fontcolor4").style.backgroundColor=c}function menuBuilder(){rteFontFace?document.getElementById("rtefontface").style.display="":document.getElementById("rtefontface").style.display="none",rteFontSize?document.getElementById("rtefontsize").style.display="":document.getElementById("rtefontsize").style.display="none",rteFontColor?document.getElementById("rtefontcolor").style.display="":document.getElementById("rtefontcolor").style.display="none",rteBold?document.getElementById("bold").style.display="":document.getElementById("bold").style.display="none",rteItalic?document.getElementById("italic").style.display="":document.getElementById("italic").style.display="none",rteUnderline?document.getElementById("underline").style.display="":document.getElementById("underline").style.display="none",rteLeftAlign?document.getElementById("justifyleft").style.display="":document.getElementById("justifyleft").style.display="none",rteCenterAlign?document.getElementById("justifycenter").style.display="":document.getElementById("justifycenter").style.display="none",rteRightAlign?document.getElementById("justifyright").style.display="":document.getElementById("justifyright").style.display="none",rteFullAlign?document.getElementById("justifyfull").style.display="":document.getElementById("justifyfull").style.display="none",rteHorizontalRule?document.getElementById("inserthorizontalrule").style.display="":document.getElementById("inserthorizontalrule").style.display="none",rteFontFace||rteFontSize||rteFontColor||(document.getElementById("rtesep1").style.display="none",document.getElementById("rtesep2").style.display="none"),rteBold||rteItalic||rteUnderline||(document.getElementById("rtesep3").style.display="none"),rteLeftAlign||rteCenterAlign||rteRightAlign||rteFullAlign||rteHorizontalRule||(document.getElementById("rtesep4").style.display="none"),rteFontFace||rteFontSize||rteBold||rteItalic||rteUnderline||rteLeftAlign||rteCenterAlign||rteRightAlign||rteFullAlign||rteHorizontalRule||rteSuperscript||rteSubscript||(document.getElementById("tb1").style.display="none")}function initRTE(e,t){document.designMode?(document.write("<style>"),document.write(".rtebg {"),document.write("	background-image:url("+rteImagePath+"bg.gif);"),document.write("	font-family:Arial, Helvetica, sans-serif;"),document.write("	font-size:10px;"),document.write("}"),document.write(".rtedropdown1 {"),document.write("	height:16px;"),document.write("	font-family:Arial, Helvetica, sans-serif;"),document.write("	padding-left:3px;"),document.write("	padding-right:3px;"),document.write("	font-size:11px;"),document.write("	border:1px solid #FFFFFF;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown2 {"),document.write("	width:11px;"),document.write("	background-image:url("+rteImagePath+"bg.gif);"),document.write("	border-top:1px solid #FFFFFF;"),document.write("	border-right:1px solid #FFFFFF;"),document.write("	border-bottom:1px solid #FFFFFF;"),document.write("	cursor:default;"),document.all&&!window.opera?document.write("	height:20px;"):document.write("	height:16px;"),document.write("}"),document.write(".rtedropdown4 {"),document.write("	font-family:Arial, Helvetica, sans-serif;"),document.write("	padding-left:3px;"),document.write("	padding-right:3px;"),document.write("	font-size:11px;"),document.write("	border:1px solid #002D96;"),document.write("	cursor:default;"),document.all&&!window.opera?document.write("	line-height:18px;"):document.write("	height:16px;"),document.write("}"),document.write(".rtedropdown5 {"),document.write("	background-image:url("+rteImagePath+"bgover.gif);"),document.write("	border-top:1px solid #000080;"),document.write("	border-right:1px solid #000080;"),document.write("	border-bottom:1px solid #000080;"),document.write("	cursor:default;"),document.all&&!window.opera?document.write("	height:20px;"):document.write("	height:16px;"),document.write("}"),document.write(".rtedropdown5b {"),document.write("	background-image:url("+rteImagePath+"bgover.gif);"),document.write("	border-top:1px solid #000080;"),document.write("	border-right:1px solid #000080;"),document.write("	border-bottom:1px solid #000080;"),document.write("	cursor:default;"),document.all&&!window.opera?document.write("	height:21px;"):document.write("	height:19px;"),document.write("}"),document.write(".rtedropdown6 {"),document.write("	width:11px;"),document.write("	background-image:url("+rteImagePath+"bgdown.gif);"),document.write("	border-top:1px solid #000080;"),document.write("	border-right:1px solid #000080;"),document.write("	border-bottom:1px solid #000080;"),document.write("	cursor:default;"),document.all&&!window.opera?document.write("	height:20px;"):document.write("	height:16px;"),document.write("}"),document.write(".rtedropdown7 {"),document.write("	border:1px solid #002D96;"),document.write("	background-color:#FFFFFF;"),document.write("	font-family:Arial, Helvetica, sans-serif;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown8 {"),document.write("	background-image:url("+rteImagePath+"bgover.gif);"),document.write("	border:1px solid #002D96;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown9 {"),document.write("	background-image:url("+rteImagePath+"bgdown.gif);"),document.write("	border-top:1px solid #000080;"),document.write("	border-right:1px solid #000080;"),document.write("	border-bottom:1px solid #000080;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown9b {"),document.write("	background-image:url("+rteImagePath+"bgdown.gif);"),document.write("	border-top:1px solid #000080;"),document.write("	border-right:1px solid #000080;"),document.write("	border-bottom:1px solid #000080;"),document.write("	cursor:default;"),document.all&&!window.opera?document.write("	height:21px;"):document.write("	height:19px;"),document.write("}"),document.write(".rtedropdown10 {"),document.write("	border:0px solid transparent;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown11 {"),document.write("	border-top:0px solid transparent;"),document.write("	border-right:0px solid transparent;"),document.write("	border-bottom:0px solid transparent;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown11b {"),document.write("	border-top:0px solid transparent;"),document.write("	border-right:0px solid transparent;"),document.write("	border-bottom:0px solid transparent;"),
document.write("	cursor:default;"),document.write("	height:19px;"),document.write("}"),document.write(".rtedropdown12 {"),document.write("	background-image:url("+rteImagePath+"bgdown.gif);"),document.write("	border:1px solid #000080;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtedropdown13 {"),document.write("	padding:1px;"),document.write("	border:1px solid #FFFFFF;"),document.write("	background-color:#FFFFFF;"),document.write("}"),document.write(".rtedropdown14 {"),document.write("	padding:1px;"),document.write("	border:1px solid #000080;"),document.write("	background-color:#FFEEC2;"),document.write("}"),document.write(".rtebtn1 {"),document.write("	display:block;"),document.write("	width:21px;"),document.write("	height:20px;"),document.write("	padding: 1px;"),document.write("	background-image:url("+rteImagePath+"bg.gif);"),document.write("}"),document.write(".rtebtn2 {"),document.write("	display:block;"),document.write("	width:21px;"),document.write("	height:20px;"),document.write("	border:1px solid #000080;"),document.write("	background-image:url("+rteImagePath+"bgover.gif);"),document.write("}"),document.write(".rtebtn3 {"),document.write("	display:block;"),document.write("	width:21px;"),document.write("	height:20px;"),document.write("	border:1px solid #000080;"),document.write("	background-image:url("+rteImagePath+"bgselect.gif);"),document.write("}"),document.write(".rtebtn4 {"),document.write("	display:block;"),document.write("	width:21px;"),document.write("	height:20px;"),document.write("	border:1px solid #000080;"),document.write("	background-image:url("+rteImagePath+"bgdown.gif);"),document.write("}"),document.write(".rtebtn5 {"),document.write("	display:block;"),document.write("	width:21px;"),document.write("	height:20px;"),document.write("	padding: 1px;"),document.write("	background-image:url("+rteImagePath+"bg.gif);"),document.write("}"),document.write(".rtebtn6 {"),document.write("	display:block;"),document.write("	padding: 3px;"),document.write("	cursor:default;"),document.write("}"),document.write(".rtebtn7 {"),document.write("	display:block;"),document.write("	border:1px solid #000080;"),document.write("	background-image:url("+rteImagePath+"bgover.gif);"),document.write("	cursor:default;"),document.write("	padding: 2px;"),document.write("}"),document.write(".rtebtn8 {"),document.write("	display:block;"),document.write("	border:1px solid #000080;"),document.write("	background-image:url("+rteImagePath+"bgselect.gif);"),document.write("	cursor:default;"),document.write("	padding: 2px;"),document.write("}"),document.write(".rtebtn9 {"),document.write("	display:block;"),document.write("	border:1px solid #000080;"),document.write("	background-image:url("+rteImagePath+"bgdown.gif);"),document.write("	cursor:default;"),document.write("	padding: 2px;"),document.write("}"),document.write("</style>"),document.write('<input type="hidden" id="preview_css" value="'+t+'">'),document.write('<input type="hidden" id="iframe_name" value="'+rteName+'">'),document.write('<table style="width:'+rteWidth+';border-left:1px solid #3B619C;border-right:1px solid #3B619C;border-top:1px solid #3B619C;" cellpadding="0" cellspacing="0">'),document.write("  <tr>"),document.write('    <td bgcolor="#C3DAF9">'),document.write('	<table cellpadding="0" cellspacing="0" id="tb1" onmousedown="return false;">'),document.write("      <tr>"),document.write('        <td width="7"><img src="'+rteImagePath+'start.gif" width="7" height="25"></td>'),document.write('        <td class="rtebg" id="rtesep1"><img src="'+rteImagePath+'blank.gif"></td>'),document.write('        <td class="rtebg"><img src="'+rteImagePath+'blank.gif"></td>'),document.write('        <td background="'+rteImagePath+'bg.gif" id="rtefontface">'),document.write('		<table style="width:110px;" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" title="Font">'),document.write("          <tr>"),document.write('            <td nowrap><div unselectable="on" id="fontface1" class="rtedropdown1" style="width:98px;font-family:arial;font-size:11px;color:#000000;">Verdana</div></td>'),document.write('            <td><div unselectable="on" id="fontface2" class="rtedropdown2"><img src="'+rteImagePath+'arrow.gif" width="11" height="16"></div></td>'),document.write("          </tr>"),document.write("        </table>"),document.write('		<div id="fontface3" class="rtedropdown7" style="position:absolute;display:none;">'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:arial;padding:5px;" nowrap>Arial</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:arial black;padding:5px;" nowrap>Arial Black</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:arial narrow;padding:5px;" nowrap>Arial Narrow</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:courier new;padding:5px;" nowrap>Courier New</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:century gothic;padding:5px;" nowrap>Century Gothic</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:comic sans ms;padding:5px;" nowrap>Comic Sans MS</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:impact;padding:5px;" nowrap>Impact</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:tahoma;padding:5px;" nowrap>Tahoma</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:times new roman;padding:5px;" nowrap>Times New Roman</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:trebuchet ms;padding:5px;" nowrap>Trebuchet MS</div>'),document.write('			<div unselectable="on" id="fontface" style="color:#000000;font-family:verdana;padding:5px;" nowrap>Verdana</div>'),document.write("		</div>"),document.write("        </td>"),document.write('        <td class="rtebg"><img src="'+rteImagePath+'blank.gif"></td>'),document.write('        <td background="'+rteImagePath+'bg.gif" id="rtefontsize">'),document.write('		<table width="100%" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF" title="Font Size">'),document.write("          <tr>"),document.write('            <td><div unselectable="on" id="fontsize1" class="rtedropdown1" style="font-family:arial;font-size:11px;color:#000000;">2</div></td>'),document.write('            <td><div unselectable="on" id="fontsize2" class="rtedropdown2"><img src="'+rteImagePath+'arrow.gif" width="11" height="16"></div></td>'),document.write("          </tr>"),document.write("        </table>"),document.write('		<div id="fontsize3" class="rtedropdown7" style="position:absolute;display:none;">'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:7px;padding:5px;">1</div>'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:10px;padding:5px;">2</div>'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:12px;padding:5px;">3</div>'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:13px;padding:5px;">4</div>'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:17px;padding:5px;">5</div>'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:23px;padding:5px;">6</div>'),document.write('			<div unselectable="on" id="fontface" style="font-family:arial;color:#000000;font-size:35px;padding:5px;">7</div>'),document.write("		</div>"),document.write("        </td>"),document.write('        <td class="rtebg"><img src="'+rteImagePath+'blank.gif"></td>'),document.write('        <td class="rtebg" id="rtefontcolor" title="Font Color">'),document.write('        	<table style="width:35px;" border="0" cellspacing="0" cellpadding="0">'),document.write("        		<tr>"),!document.all||window.opera?(document.write('        			<td><div id="fontcolor1" align="center" class="rtedropdown5" style="padding-bottom:1px;"><img src="'+rteImagePath+'fontcolor.gif"><br/><img id="fontcolor4" src="'+rteImagePath+'fontcolor2.gif" style="background-color:#FF0000;"></div></td>'),document.write('        			<td><div align="center" id="fontcolor2" class="rtedropdown8"><img src="'+rteImagePath+'arrow.gif"></div></td>')):(document.write('        			<td><div id="fontcolor1" align="center" class="rtedropdown5" style="padding-bottom:1px;"><img src="'+rteImagePath+'fontcolor.gif"><br/><img id="fontcolor4" src="'+rteImagePath+'fontcolor2.gif" style="background-color:#FF0000;"></div></td>'),document.write('        			<td><div align="center" id="fontcolor2" class="rtedropdown8"><img src="'+rteImagePath+'arrow.gif"></div></td>')),document.write("        		</tr>"),document.write("        	</table>"),document.write('		<div id="fontcolor3" class="rtedropdown7" style="position:absolute;display:none;padding:4px;border:1px solid #002D96;">'),document.write('			<table border="0" cellspacing="1" cellpadding="0">'),document.write("				<tr>"),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#000000;" onClick="rteColorClick(\'#000000\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#993300;" onClick="rteColorClick(\'#993300\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#333300;" onClick="rteColorClick(\'#333300\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#003300;" onClick="rteColorClick(\'#003300\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#003366;" onClick="rteColorClick(\'#003366\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#000080;" onClick="rteColorClick(\'#000080\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#333399;" onClick="rteColorClick(\'#333399\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#333333;" onClick="rteColorClick(\'#333333\');"></div></td>'),document.write("				</tr>"),document.write("				<tr>"),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#800000;" onClick="rteColorClick(\'#800000\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FF6600;" onClick="rteColorClick(\'#FF6600\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#808000;" onClick="rteColorClick(\'#808000\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#008000;" onClick="rteColorClick(\'#008000\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#008080;" onClick="rteColorClick(\'#008080\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#0000FF;" onClick="rteColorClick(\'#0000FF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#666699;" onClick="rteColorClick(\'#666699\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#808080;" onClick="rteColorClick(\'#808080\');"></div></td>'),document.write("				</tr>"),document.write("				<tr>"),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FF0000;" onClick="rteColorClick(\'#FF0000\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FF9900;" onClick="rteColorClick(\'#FF9900\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#99CC00;" onClick="rteColorClick(\'#99CC00\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#339966;" onClick="rteColorClick(\'#339966\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#33CCCC;" onClick="rteColorClick(\'#33CCCC\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#3366FF;" onClick="rteColorClick(\'#3366FF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#800080;" onClick="rteColorClick(\'#800080\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#999999;" onClick="rteColorClick(\'#999999\');"></div></td>'),document.write("				</tr>"),document.write("				<tr>"),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FF00FF;" onClick="rteColorClick(\'#FF00FF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FFCC00;" onClick="rteColorClick(\'#FFCC00\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FFFF00;" onClick="rteColorClick(\'#FFFF00\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#00FF00;" onClick="rteColorClick(\'#00FF00\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#00FFFF;" onClick="rteColorClick(\'#00FFFF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#00CCFF;" onClick="rteColorClick(\'#00CCFF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#993366;" onClick="rteColorClick(\'#993366\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#C0C0C0;" onClick="rteColorClick(\'#C0C0C0\');"></div></td>'),document.write("				</tr>"),document.write("				<tr>"),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FF99CC;" onClick="rteColorClick(\'#FF99CC\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FFCC99;" onClick="rteColorClick(\'#FFCC99\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FFFF99;" onClick="rteColorClick(\'#FFFF99\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#CCFFCC;" onClick="rteColorClick(\'#CCFFCC\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#CCFFFF;" onClick="rteColorClick(\'#CCFFFF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#99CCFF;" onClick="rteColorClick(\'#99CCFF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#CC99FF;" onClick="rteColorClick(\'#CC99FF\');"></div></td>'),document.write('					<td><div id="fontcolor" class="rtedropdown13"><img src="'+rteImagePath+'fontcolor3.gif" style="background-color:#FFFFFF;" onClick="rteColorClick(\'#FFFFFF\');"></div></td>'),document.write("				</tr>"),document.write("			</table>"),document.write("		</div>"),document.write("        </td>"),document.write('        <td class="rtebg" id="rtesep2"><img src="'+rteImagePath+'seperator.gif"></td>'),document.write('        <td class="rtebg" title="Bold"><div id="bold" class="rtebtn1"><img src="'+rteImagePath+'bold.gif"></div></td>'),document.write('        <td class="rtebg" title="Italic"><div id="italic" class="rtebtn1"><img src="'+rteImagePath+'italic.gif"></div></td>'),document.write('        <td class="rtebg" title="Underline"><div id="underline" class="rtebtn1"><img src="'+rteImagePath+'underline.gif"></div></td>'),document.write('        <td class="rtebg" id="rtesep3"><img src="'+rteImagePath+'seperator.gif"></td>'),document.write('        <td class="rtebg" title="Align Left"><div id="justifyleft" class="rtebtn1"><img src="'+rteImagePath+'leftalign.gif" width="21" height="20"></div></td>'),document.write('        <td class="rtebg" title="Center"><div id="justifycenter" class="rtebtn1"><img src="'+rteImagePath+'centeralign.gif"></div></td>'),document.write('        <td class="rtebg" title="Align Right"><div id="justifyright" class="rtebtn1"><img src="'+rteImagePath+'rightalign.gif"></div></td>'),document.write('        <td class="rtebg" title="Justify"><div id="justifyfull" class="rtebtn1"><img src="'+rteImagePath+'fullalign.gif"></div></td>'),document.write('        <td class="rtebg" title="Horizontal Rule"><div id="inserthorizontalrule" class="rtebtn1"><img src="'+rteImagePath+'hr.gif"></div></td>'),document.write('        <td width="5"><img src="'+rteImagePath+'finish.gif" width="5" height="25"></td>'),document.write('		<td width="100%"></td>'),document.write("      </tr>"),document.write("    </table></td>"),document.write("  </tr>"),document.write("  <tr>"),document.write('    <td style="border:1px solid #C3DAF9; ">'),document.write('		<iframe name="'+rteName+'" id="'+rteName+'" style="width:100%; height:'+rteHeight+'px; background-color:#FFFFFF;" frameborder="0"></iframe>'),document.write('		<textarea name="'+rteFormName+'" id="'+rteFormName+'" style="display:none;width:'+rteWidth+"; height:"+rteHeight+'px; background-color:#FFFFFF; font-family:courier new; font-size:12px; color:#000000; border:0px;"></textarea>'),document.write('		<iframe id="preview_'+rteName+'" style="width:'+rteWidth+"; height:"+rteHeight+'px; background-color:#FFFFFF; display:none;" frameborder="0"></iframe>'),document.write("	</td>"),document.write("  </tr>"),document.write("  <tr>"),document.write('    <td bgcolor="#c3daf9" height="25" class="rtebg" align="right" style="padding-right:3px" onmousedown="return false;">'),document.write('            <a class="saveTextButton" onclick="returnRezulText();">&nbsp;'+saveBtnText+'&nbsp;</a> <a class="saveTextButton" onclick="closeWithOutRezulText();">&nbsp;'+cancelBtnText+"&nbsp;</a>"),document.write("    </td>"),document.write("  </tr>"),document.write("</table>"),startRTE(e),menuBuilder()):document.write('<textarea id="'+rteFormName+'" name="'+rteFormName+'" style="width:'+rteWidth+";height:"+rteHeight+'px;"></textarea>'),$("#"+rteName).contents().keyup(function(e){checkInputTextSize()}),$("#text-editor").css({display:"none"})}function checkInputTextSize(){}var oldContentRte="";rteWidth="100%",rteName="freeRTE",rteFormName="freeRTE_content",rteHeight="272",rteMaxHeight="485",rteImagePath=basePath+"/public/theme/rte/",rteFontFace=!0,rteFontSize=!0,rteFontColor=!0,rteBold=!0,rteItalic=!0,rteUnderline=!0,rteLeftAlign=!0,rteCenterAlign=!0,rteRightAlign=!0,rteFullAlign=!0,rteHorizontalRule=!0,Html2Xhtml.prototype.setHTML=function(e){this.data=e||this.data},Html2Xhtml.prototype.parse=function(){for(var e=0,t="",o=0,n=!1,r="",d="",i="",c="",m=this.data,u=m.length,l="",a=0,s=!1;;){if(o>=u&&!n)return t;if(n)n=!1;else var g=m.substr(o++,1);switch(e){case 0:if("<"==g){e=1;break}var f=g.charCodeAt();t+=Html2Xhtml.charEntities[f]?"&"+Html2Xhtml.charEntities[f]+";":g;break;case 1:if(/[a-zA-Z]/.test(g)){e=2,a=1,r=g.toLowerCase();break}if("/"==g){e=2,a=-1;break}if("!"==g){if("--"==m.substr(o,2)){t+="<!--",o+=2,e=9;break}t+="<!",e=10;break}if("?"==g){e=11,t+="<?";break}t+="&lt;",n=!0,e=0;break;case 2:if(Html2Xhtml.isSpaceChar[g]){t+=(!s&&a>0&&Html2Xhtml.hasNLBefore[r]&&t.length&&"\n"!=t.substr(t.length-1,1)?"\n":"")+(a>0?"<":"</")+r,e=3;break}if("/"==g){if(t+=(!s&&a>0&&Html2Xhtml.hasNLBefore[r]&&t.length&&"\n"!=t.substr(t.length-1,1)?"\n":"")+(a>0?"<":"</")+r,">"!=m.substr(o,1)){e=3;break}e=4;break}if(">"==g){t+=(!s&&a>0&&Html2Xhtml.hasNLBefore[r]&&t.length&&"\n"!=t.substr(t.length-1,1)?"\n":"")+(a>0?"<":"</")+r,n=!0,e=4;break}r+=g.toLowerCase();break;case 3:if(Html2Xhtml.isSpaceChar[g])break;if("/"==g){if(">"!=m.substr(o,1))break;e=4;break}if(">"==g){n=!0,e=4;break}d=g.toLowerCase(),i="",e=5;break;case 4:if(t+=(Html2Xhtml.isEmptyTag[r]?" />":">")+(!s&&0>a&&Html2Xhtml.hasNLAfter[r]&&u>o&&"\n"!=m.substr(o,1)?"\n":""),a>0&&Html2Xhtml.dontAnalyzeContent[r]){e=13,d=i=c="",a=0;break}"pre"==r&&(s=!s),e=0,r=d=i=c="",a=0;break;case 5:if(Html2Xhtml.isSpaceChar[g]){t+=" "+d,Html2Xhtml.isEmptyAttr[d]&&(t+='="'+d+'"'),e=3;break}if("/"==g){if(t+=" "+d,Html2Xhtml.isEmptyAttr[d]&&(t+='="'+d+'"'),">"!=m.substr(o,1)){e=3;break}e=4;break}if(">"==g){t+=" "+d,Html2Xhtml.isEmptyAttr[d]&&(t+='="'+d+'"'),n=!0,e=4;break}if("="==g){t+=" "+d+"=",e=6;break}d+='"'==g||"'"==g?"?":g.toLowerCase();break;case 6:if(Html2Xhtml.isSpaceChar[g]){t+=Html2Xhtml.isEmptyAttr[d]?'"'+d+'"':'""',e=3;break}if(">"==g){t+=Html2Xhtml.isEmptyAttr[d]?'"'+d+'"':'""',n=!0,e=4;break}if("/"==g&&">"==m.substr(o,1)){t+=Html2Xhtml.isEmptyAttr[d]?'"'+d+'"':'""',e=4;break}if('"'==g||"'"==g){c=g,e=8;break}i=g,e=7;break;case 7:if(Html2Xhtml.isSpaceChar[g]){t+='"'+Html2Xhtml.escapeQuot(i,'"')+'"',e=3;break}if("/"==g&&">"==m.substr(o,1)){t+='"'+Html2Xhtml.escapeQuot(i,'"')+'"',e=4;break}if(">"==g){n=!0,t+='"'+Html2Xhtml.escapeQuot(i,'"')+'"',e=4;break}i+=g;break;case 8:if(g==c){t+='"'+Html2Xhtml.escapeQuot(i,'"')+'"',e=3;break}i+=g;break;case 9:if("-"==g&&"->"==m.substr(o,2)){o+=2,t+="-->",e=0;break}t+=g;break;case 10:">"==g&&(e=0),t+=g;break;case 11:if("'"==g||'"'==g){c=g,e=12;break}if("?"==g&&">"==m.substr(o,1)){e=0,t+="?>",o++;break}t+=g;break;case 12:if(g==c){e=11,t+=c+Html2Xhtml.escapeQuot(l,c)+c,l=c="";break}l+=g;break;case 13:if("<"==g&&m.substr(o,r.length+1).toLowerCase()=="/"+r){n=!0,e=0,r="";break}t+="textarea"==r?Html2Xhtml.escapeHTMLChar(g):g}}return t},Html2Xhtml.escapeQuot=function(e,t){return t||(t='"'),'"'==t?e.replace(/"/gi,'\\"'):e.replace(/'/gi,"\\'")},Html2Xhtml.escapeHTMLChar=function(e){if("&"==e)return"&amp;";if("<"==e)return"&lt;";if(">"==e)return"&gt;";var t=e.charCodeAt();return Html2Xhtml.charEntities[t]?"&"+Html2Xhtml.charEntities[t]+";":e},Html2Xhtml.isSpaceChar={" ":1,"\r":1,"\n":1,"	":1},Html2Xhtml.isEmptyTag={area:1,base:1,basefont:1,br:1,hr:1,img:1,input:1,link:1,meta:1,param:1},Html2Xhtml.isEmptyAttr={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,noresize:1,nosave:1,noshade:1,nowrap:1,readonly:1,selected:1},Html2Xhtml.hasNLBefore={div:1,p:1,table:1,tbody:1,tr:1,td:1,th:1,title:1,head:1,body:1,script:1,comment:1,li:1,meta:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,ul:1,ol:1,option:1,link:1},Html2Xhtml.hasNLAfter={html:1,head:1,body:1,p:1,th:1,style:1},Html2Xhtml.dontAnalyzeContent={textarea:1,script:1,style:1},Html2Xhtml.charEntities={160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"agrave",193:"aacute",194:"acirc",195:"atilde",196:"auml",197:"aring",198:"aelig",199:"ccedil",200:"egrave",201:"eacute",202:"ecirc",203:"euml",204:"igrave",205:"iacute",206:"icirc",207:"iuml",208:"eth",209:"ntilde",210:"ograve",211:"oacute",212:"ocirc",213:"otilde",214:"ouml",215:"times",216:"oslash",217:"ugrave",218:"uacute",219:"ucirc",220:"uuml",221:"yacute",222:"thorn",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",338:"oelig",339:"oelig",352:"scaron",353:"scaron",376:"yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro",402:"fnof",913:"alpha",914:"beta",915:"gamma",916:"delta",917:"epsilon",918:"zeta",919:"eta",920:"theta",921:"iota",922:"kappa",923:"lambda",924:"mu",925:"nu",926:"xi",927:"omicron",928:"pi",929:"rho",931:"sigma",932:"tau",933:"upsilon",934:"phi",935:"chi",936:"psi",937:"omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"larr",8657:"uarr",8658:"rarr",8659:"darr",8660:"harr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9426:"copy",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams"};